miner.options = {    init: function(){        var id;        var val;        //根据存储的配置信息，初始化配置页面        $('input').each(function(){            id = $(this).attr('id');            val =  $(this).val();            if( miner.utils.empty(window.localStorage['global_setting.'+id]) ){                //如果本地存储为空，赋上元素所带的value                window.localStorage['global_setting.'+id] = val;            }else{                //否则，将本地存储的值赋到元素value上                $(this).val( window.localStorage['global_setting.'+id] );            }                        if( $(this).attr('set') == 'task_mode' ){                if( id == window.localStorage['global_setting.task_mode'] ){                    $(this).attr('checked', '');                }else{                    $(this).removeAttr('checked');                }            }                        if( id == 'enable_cookie' ){                 if( 'on' == window.localStorage['global_setting.enable_cookie'] ){                    $(this).attr('checked', '');                }else{                    $(this).removeAttr('checked');                }                       }                        if( id == 'auto_clear' ){                 if( 'on' == window.localStorage['global_setting.auto_clear'] ){                    $(this).attr('checked', '');                }else{                    $(this).removeAttr('checked');                }                       }        });                $('textarea').each(function(){            id = $(this).attr('id');            val =  $(this).val();                        if( miner.utils.empty(window.localStorage['global_setting.'+id]) ){                window.localStorage['global_setting.'+id] = val;            }else{                $(this).val( window.localStorage['global_setting.'+id] );            }                        });                //更新版本信息        $('.version_info').each(function(){            id = $(this).attr('id');            if( !miner.utils.empty(window.localStorage['version_info.'+id]) ){                $(this).val( window.localStorage['version_info.'+id] );            }        });                /*        for(i=0; i<window.localStorage.length; i++){              key = window.localStorage.key(i);              keyArray = key.split('global_setting.');            if( '' == keyArray[0] && '' != keyArray[1] ){                $( '#'+keyArray[1]).val(window.localStorage.getItem('global_setting.'+keyArray[1]) );            }        }        */        /*        var guid = window.localStorage["global_setting.guid"];        if( null == guid || 'undefined' == guid ){            guid = miner.utils.genGuid();            window.localStorage["global_setting.guid"] = guid;        }        $( '#guid').val(guid);        */    }};$(function() {    $( "#tabs" ).tabs();        miner.options.init();        //所有表格元素事件都托管到tabs    $("#tabs").change(function() {        if( $(event.target).is('input')){            switch(event.target.type)            {                case 'checkbox':                    switch($(event.target).attr('set'))                    {                        case 'enable_cookie':                            //alert($(event.target).attr("id")+':'+$(event.target).attr("checked"));                            if( $(event.target).is(":checked") ){                                                            if( true == confirm('带cookie扫描可能会造成脏数据、页面扭曲等非预期效果，请谨慎选择！') ){                                    window.localStorage['global_setting.enable_cookie'] = 'on';                                }else{                                    $(event.target).removeAttr("checked");                                    window.localStorage['global_setting.enable_cookie'] = 'off';                                }                                                            }else{                                window.localStorage['global_setting.enable_cookie'] = 'off';                            }                            break;                        case 'auto_clear':                            if( $(event.target).is(":checked") ){                                window.localStorage['global_setting.auto_clear'] = 'on';                            }else{                                window.localStorage['global_setting.auto_clear'] = 'off';                            }                            break;                        case 'traffic_type':                                                    break;                        case 'traffic_method':                                                    break;                        case 'scan_plugins':                                                    break;                        case 'scan_step':                                                    break;                        default:                            //alert('unknown set');                            break;                    }                    break;                case 'radio':                    if( 'task_mode' == $(event.target).attr('set') ){                        window.localStorage['global_setting.task_mode'] = event.target.id;                    }                    break;                case 'number':                    window.localStorage['global_setting.'+event.target.id] = $(event.target).val();                    break;                    default:                    //alert('unknown');                    window.localStorage['global_setting.'+event.target.id] = $(event.target).val();                    break;            }            //alert( 'set='+$(event.target).attr('set')+',type='+event.target.type+',id='+event.target.id+',value='+$(event.target).val()+',checked='+event.target.checked);        }    });    //text和textarea的change事件需要onblur触发，但用户直接切换页面并不会触发该事件，因此改用keyup    $("#tabs").keyup(function() {        if( $(event.target).is('input') && event.target.type == 'text'){            window.localStorage['global_setting.'+event.target.id] = $(event.target).val();        }else if( $(event.target).is('textarea') ){            window.localStorage['global_setting.'+event.target.id] = $(event.target).val();        }        });});